<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineSearch TV</title>
    
    <!-- Font Awesome per icone -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Video.js per TV -->
    <link href="https://vjs.zencdn.net/8.16.1/video-js.css" rel="stylesheet">
    <script src="https://vjs.zencdn.net/8.16.1/video.min.js"></script>
    
    <!-- Video.js HLS Quality Selector -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/videojs-hls-quality-selector@2.0.0/dist/videojs-hls-quality-selector.min.css">
    <script src="https://cdn.jsdelivr.net/npm/videojs-hls-quality-selector@2.0.0/dist/videojs-hls-quality-selector.min.js"></script>
    
    <!-- Nostri stili -->
    <link rel="stylesheet" href="tv-style.css">
    
    <!-- Favicon -->
    <link rel="icon" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/svgs/solid/film.svg">
</head>
<body class="tv-mode">
    <!-- Overlay di caricamento iniziale -->
    <div id="loading-overlay" class="fullscreen-loading">
        <div class="loading-tv">
            <div class="loading-spinner"></div>
            <div class="loading-text">Caricamento CineSearch TV...</div>
            <div class="loading-subtext">Ottimizzato per Smart TV</div>
        </div>
    </div>

    <!-- Header fisso con controllo focus -->
<header id="tv-header" class="tv-header">
<div class="tv-logo-static">
    <i class="fas fa-tv"></i>
    <span>CineSearch TV</span>
</div>
        
        <div class="tv-header-controls">
            <!-- CORS Proxy Selector -->
            <div class="tv-cors-selector" data-focus="cors">
                <label for="tv-cors-select">üåê Proxy</label>
                <select id="tv-cors-select" tabindex="0"></select>
            </div>
            
            <!-- Barra di ricerca -->
<div class="tv-search-container" data-focus="search" role="search">
    <input type="text" id="tv-search" 
           placeholder="üîç Cerca film, serie TV..." 
           tabindex="0"
           aria-label="Cerca film o serie TV"
           autocorrect="on"
           autocomplete="on"
           spellcheck="true"
           inputmode="text">
    <button id="tv-search-btn" class="tv-search-btn" tabindex="0" aria-label="Avvia ricerca">
        <i class="fas fa-search"></i>
    </button>
</div>
            
            <!-- Contatore preferiti -->
            <div class="tv-preferiti-counter" id="tv-preferiti-counter" 
                 data-focus="preferiti" tabindex="0" 
                 aria-label="Apri preferiti">
                <i class="fas fa-star"></i>
                <span id="tv-preferiti-count">0</span>
            </div>
        </div>
        
        <!-- Indicatore focus visivo -->
        <div class="focus-indicator" id="focus-indicator"></div>
    </header>

    <!-- Barra di navigazione principale -->
    <nav class="tv-nav" id="tv-nav">
        <button class="tv-nav-btn active" data-focus="nav-home" tabindex="0" 
                onclick="showHome()" aria-label="Home">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </button>
        
        <button class="tv-nav-btn" data-focus="nav-movies" tabindex="0"
                onclick="showAllMovies()" aria-label="Tutti i film">
            <i class="fas fa-film"></i>
            <span>Film</span>
        </button>
        
        <button class="tv-nav-btn" data-focus="nav-series" tabindex="0"
                onclick="showAllTV()" aria-label="Tutte le serie TV">
            <i class="fas fa-tv"></i>
            <span>Serie TV</span>
        </button>
        
        <button class="tv-nav-btn" data-focus="nav-categories" tabindex="0"
                onclick="showCategories()" aria-label="Categorie">
            <i class="fas fa-tags"></i>
            <span>Categorie</span>
        </button>
        
        <button class="tv-nav-btn" data-focus="nav-favorites" tabindex="0"
                onclick="showPreferiti()" aria-label="Preferiti">
            <i class="fas fa-star"></i>
            <span>Preferiti</span>
        </button>
        
        <button class="tv-nav-btn" data-focus="nav-continue" tabindex="0"
                onclick="showContinuaVisione()" aria-label="Continua visione">
            <i class="fas fa-play-circle"></i>
            <span>Continua</span>
        </button>
    </nav>

    <!-- Contenuto principale -->
    <main id="tv-main" class="tv-main">
        <!-- HOME -->
        <section id="tv-home" class="tv-section active">
            <div class="tv-hero">
                <h1 class="tv-hero-title">Benvenuto su CineSearch TV</h1>
                <p class="tv-hero-subtitle">La tua piattaforma ottimizzata per Smart TV</p>
            </div>

            <!-- Sezione CONTINUA VISIONE -->
            <section id="tv-continua" class="tv-content-section">
                <h2 class="tv-section-title" data-focus="tv-continua-section" tabindex="0">
                    <i class="fas fa-play-circle"></i>
                    Continua la visione
                </h2>
                <div class="tv-carousel-wrapper">
                    <button class="tv-carousel-btn left" onclick="scrollCarousel('continua-carousel', -1)" 
                            aria-label="Scorri a sinistra" tabindex="0">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="tv-carousel-container">
                        <div class="tv-carousel" id="continua-carousel"></div>
                    </div>
                    <button class="tv-carousel-btn right" onclick="scrollCarousel('continua-carousel', 1)"
                            aria-label="Scorri a destra" tabindex="0">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <div class="tv-empty-state" id="continua-empty">
                    <i class="fas fa-play-circle"></i>
                    <p>Guarda un contenuto per almeno 1 minuto per vederlo qui</p>
                </div>
            </section>

            <!-- Sezione TRENDING -->
            <section id="tv-trending" class="tv-content-section">
                <h2 class="tv-section-title" data-focus="tv-trending-section" tabindex="0">
                    <i class="fas fa-fire"></i>
                    Trending
                </h2>
                <div class="tv-carousel-wrapper">
                    <button class="tv-carousel-btn left" onclick="scrollCarousel('trending-carousel', -1)"
                            aria-label="Scorri a sinistra" tabindex="0">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="tv-carousel-container">
                        <div class="tv-carousel" id="trending-carousel"></div>
                    </div>
                    <button class="tv-carousel-btn right" onclick="scrollCarousel('trending-carousel', 1)"
                            aria-label="Scorri a destra" tabindex="0">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </section>

            <!-- Sezione FILM IN ONDA -->
            <section id="tv-now-playing" class="tv-content-section">
                <h2 class="tv-section-title" data-focus="tv-now-playing-section" tabindex="0">
                    <i class="fas fa-film"></i>
                    Film in onda
                </h2>
                <div class="tv-carousel-wrapper">
                    <button class="tv-carousel-btn left" onclick="scrollCarousel('now-playing-carousel', -1)"
                            aria-label="Scorri a sinistra" tabindex="0">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="tv-carousel-container">
                        <div class="tv-carousel" id="now-playing-carousel"></div>
                    </div>
                    <button class="tv-carousel-btn right" onclick="scrollCarousel('now-playing-carousel', 1)"
                            aria-label="Scorri a destra" tabindex="0">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </section>

            <!-- Sezione SERIE TV IN ONDA -->
            <section id="tv-on-air" class="tv-content-section">
                <h2 class="tv-section-title" data-focus="tv-on-air-section" tabindex="0">
                    <i class="fas fa-tv"></i>
                    Serie TV in onda
                </h2>
                <div class="tv-carousel-wrapper">
                    <button class="tv-carousel-btn left" onclick="scrollCarousel('on-air-carousel', -1)"
                            aria-label="Scorri a sinistra" tabindex="0">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="tv-carousel-container">
                        <div class="tv-carousel" id="on-air-carousel"></div>
                    </div>
                    <button class="tv-carousel-btn right" onclick="scrollCarousel('on-air-carousel', 1)"
                            aria-label="Scorri a destra" tabindex="0">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </section>
        </section>

        <!-- TUTTI I FILM -->
        <section id="tv-all-movies" class="tv-section">
            <div class="tv-grid-header">
                <button class="tv-back-btn" onclick="showHome()" tabindex="0" aria-label="Torna alla home">
                    <i class="fas fa-arrow-left"></i>
                    Torna alla Home
                </button>
                <h2 class="tv-grid-title">
                    <i class="fas fa-film"></i>
                    Tutti i Film
                </h2>
                
                <!-- Pulsante per mostrare/nascondere filtri -->
                <button class="tv-filter-toggle-btn" id="tv-movie-filter-toggle" 
                        data-focus="tv-movie-filter-toggle" tabindex="0" 
                        onclick="toggleYearFilter('movie')">
                    <i class="fas fa-filter"></i>
                    <span id="tv-movie-filter-text">Mostra Filtri Anno</span>
                </button>
                
                <!-- Filtri (nascosti per default) -->
                <div class="tv-filters" id="tv-movie-filters">
                    <div class="tv-year-filter">
                        <label for="tv-movie-year-min">Anno da:</label>
                        <input type="number" id="tv-movie-year-min" min="1888" max="2030" 
                               placeholder="1888" tabindex="0">
                        
                        <label for="tv-movie-year-max">a:</label>
                        <input type="number" id="tv-movie-year-max" min="1888" max="2030" 
                               placeholder="2025" tabindex="0">
                        
                        <button class="tv-filter-btn" onclick="applyMovieYearFilter()" tabindex="0" 
                                data-focus="tv-movie-apply-filter">
                            Applica
                        </button>
                        <button class="tv-filter-btn reset" onclick="clearMovieYearFilter()" tabindex="0"
                                data-focus="tv-movie-reset-filter">
                            Reset
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="tv-pagination-info" id="tv-movie-pagination-info">
                Caricamento film...
            </div>
            
            <div class="tv-vertical-grid" id="tv-all-movies-grid"></div>
            
            <div class="tv-pagination-controls">
                <button class="tv-page-btn prev" onclick="prevMoviePage()" tabindex="0" disabled
                        data-focus="tv-movie-prev-page">
                    <i class="fas fa-chevron-left"></i> Precedente
                </button>
                <span class="tv-page-info" id="tv-movie-page-info">Pagina 1</span>
                <button class="tv-page-btn next" onclick="nextMoviePage()" tabindex="0"
                        data-focus="tv-movie-next-page">
                    Successiva <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </section>

        <!-- TUTTE LE SERIE TV -->
        <section id="tv-all-series" class="tv-section">
            <div class="tv-grid-header">
                <button class="tv-back-btn" onclick="showHome()" tabindex="0" aria-label="Torna alla home">
                    <i class="fas fa-arrow-left"></i>
                    Torna alla Home
                </button>
                <h2 class="tv-grid-title">
                    <i class="fas fa-tv"></i>
                    Tutte le Serie TV
                </h2>
                
                <!-- Pulsante per mostrare/nascondere filtri -->
                <button class="tv-filter-toggle-btn" id="tv-series-filter-toggle" 
                        data-focus="tv-series-filter-toggle" tabindex="0"
                        onclick="toggleYearFilter('series')">
                    <i class="fas fa-filter"></i>
                    <span id="tv-series-filter-text">Mostra Filtri Anno</span>
                </button>
                
                <!-- Filtri (nascosti per default) -->
                <div class="tv-filters" id="tv-series-filters">
                    <div class="tv-year-filter">
                        <label for="tv-series-year-min">Anno da:</label>
                        <input type="number" id="tv-series-year-min" min="1888" max="2030" 
                               placeholder="1888" tabindex="0" data-focus="tv-series-year-min">
                        
                        <label for="tv-series-year-max">a:</label>
                        <input type="number" id="tv-series-year-max" min="1888" max="2030" 
                               placeholder="2025" tabindex="0" data-focus="tv-series-year-max">
                        
                        <button class="tv-filter-btn" onclick="applySeriesYearFilter()" tabindex="0"
                                data-focus="tv-series-apply-filter">
                            Applica
                        </button>
                        <button class="tv-filter-btn reset" onclick="clearSeriesYearFilter()" tabindex="0"
                                data-focus="tv-series-reset-filter">
                            Reset
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="tv-pagination-info" id="tv-series-pagination-info">
                Caricamento serie TV...
            </div>
            
            <div class="tv-vertical-grid" id="tv-all-series-grid"></div>
            
            <div class="tv-pagination-controls">
                <button class="tv-page-btn prev" onclick="prevSeriesPage()" tabindex="0" disabled
                        data-focus="tv-series-prev-page">
                    <i class="fas fa-chevron-left"></i> Precedente
                </button>
                <span class="tv-page-info" id="tv-series-page-info">Pagina 1</span>
                <button class="tv-page-btn next" onclick="nextSeriesPage()" tabindex="0"
                        data-focus="tv-series-next-page">
                    Successiva <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </section>

        <!-- CATEGORIE -->
        <section id="tv-categories" class="tv-section">
            <div class="tv-grid-header">
                <button class="tv-back-btn" onclick="showHome()" tabindex="0" aria-label="Torna alla home">
                    <i class="fas fa-arrow-left"></i>
                    Torna alla Home
                </button>
                <h2 class="tv-grid-title">
                    <i class="fas fa-tags"></i>
                    Categorie
                </h2>
            </div>
            
            <div class="tv-categories-grid" id="tv-categories-grid"></div>
        </section>

        <!-- PREFERITI -->
        <section id="tv-preferiti" class="tv-section">
            <div class="tv-grid-header">
                <button class="tv-back-btn" onclick="showHome()" tabindex="0" aria-label="Torna alla home">
                    <i class="fas fa-arrow-left"></i>
                    Torna alla Home
                </button>
                <h2 class="tv-grid-title">
                    <i class="fas fa-star"></i>
                    I tuoi Preferiti
                </h2>
            </div>
            
            <div class="tv-vertical-grid" id="tv-preferiti-grid"></div>
            
            <div class="tv-empty-state" id="tv-preferiti-empty">
                <i class="fas fa-star"></i>
                <h3>Nessun preferito</h3>
                <p>Aggiungi contenuti ai preferiti per vederlo qui</p>
                <button class="tv-empty-btn" onclick="showAllMovies()" tabindex="0">
                    Esplora Film
                </button>
            </div>
        </section>

        <!-- RISULTATI RICERCA -->
        <section id="tv-search-results" class="tv-section">
            <div class="tv-grid-header">
                <button class="tv-back-btn" onclick="showHome()" tabindex="0" aria-label="Torna alla home">
                    <i class="fas fa-arrow-left"></i>
                    Torna alla Home
                </button>
                <h2 class="tv-grid-title" id="tv-search-title">
                    <i class="fas fa-search"></i>
                    Risultati ricerca
                </h2>
            </div>
            
            <div class="tv-search-status" id="tv-search-status">
                <div class="tv-loading-small"></div>
                <span>Verifica disponibilit√†...</span>
            </div>
            
            <div class="tv-vertical-grid" id="tv-search-grid"></div>
            
            <div class="tv-empty-state" id="tv-search-empty">
                <i class="fas fa-search"></i>
                <h3>Nessun risultato</h3>
                <p>Prova con un'altra ricerca</p>
            </div>
        </section>

        <!-- PLAYER -->
       <section id="tv-player" class="tv-section">
    <div class="tv-player-header">
        <button class="tv-back-btn" onclick="goBackFromPlayer()" tabindex="0" aria-label="Torna indietro"
                data-focus="tv-player-back-btn">
            <i class="fas fa-arrow-left"></i>
            Torna Indietro
        </button>
        
        <div class="tv-player-info">
            <h1 id="tv-player-title" class="tv-player-title">Titolo</h1>
            <div class="tv-player-meta" id="tv-player-meta">
                <span class="tv-meta-year">2024</span>
                <span class="tv-meta-rating">‚≠ê 8.5</span>
                <span class="tv-meta-type">Film</span>
            </div>
        </div>
    </div>
            <!-- Selezione episodi -->
        <div class="tv-episode-selector" id="tv-episode-selector">
            <h3 class="tv-episode-title">
                <i class="fas fa-list"></i>
                Seleziona Episodio
            </h3>
            
            <div class="tv-season-selector">
                <label for="tv-season-select">Stagione:</label>
                <select id="tv-season-select" tabindex="0" data-focus="tv-season-select"></select>
            </div>
            
            <div class="tv-episodes-list" id="tv-episodes-list"></div>
        </div>
        <!-- Controlli rapidi per TV -->
    <div class="tv-quick-controls">
        <button class="tv-quick-btn" onclick="playerSeek(-10)" tabindex="0" aria-label="Indietro 10 secondi"
                data-focus="tv-quick-backward">
            <i class="fas fa-backward"></i> 10s
        </button>
        <button class="tv-quick-btn" onclick="togglePlayPause()" tabindex="0" aria-label="Play/Pausa"
                data-focus="tv-quick-playpause">
            <i class="fas fa-play"></i> Play/Pausa
        </button>
        <button class="tv-quick-btn" onclick="playerSeek(30)" tabindex="0" aria-label="Avanti 30 secondi"
                data-focus="tv-quick-forward">
            <i class="fas fa-forward"></i> 30s
        </button>
        <button class="tv-quick-btn" onclick="toggleFullscreen()" tabindex="0" aria-label="Schermo intero"
                data-focus="tv-quick-fullscreen">
            <i class="fas fa-expand"></i> Fullscreen
        </button>
    </div>
    
    <div class="tv-player-content">
        <div class="tv-video-container" id="tv-video-container">

            <div id="tv-episode-warning" class="tv-episode-warning">
                <i class="fas fa-tv"></i>
                <h3>Seleziona un episodio</h3>
                <p>Scegli una stagione e un episodio per iniziare</p>
            </div>

            <div class="tv-video-wrapper">
                <video
                    id="tv-player-video"
                    class="video-js vjs-default-skin"
                    playsinline
                    preload="auto"
                    controls
                ></video>
            </div>

            <div id="tv-loading-overlay" class="tv-loading-overlay">
                <div class="tv-loading-spinner"></div>
                <div class="tv-loading-text">Caricamento stream...</div>
            </div>

        </div>
        

    </div>

</section>
    </main>

    <!-- Popup per dettagli card -->
    <div class="tv-popup-backdrop" id="card-popup-backdrop"></div>
    <div class="tv-card-popup" id="card-popup">
        <button class="tv-popup-close" onclick="closeCardPopup()" tabindex="0" aria-label="Chiudi"
                data-focus="tv-popup-close">
            <i class="fas fa-times"></i>
        </button>
        
        <div class="tv-popup-content">
            <img src="" alt="" class="tv-popup-poster" id="popup-poster">
            
            <div class="tv-popup-info">
                <h2 class="tv-popup-title" id="popup-title"></h2>
                
                <div class="tv-popup-meta" id="popup-meta"></div>
                
                <div class="tv-popup-overview" id="popup-overview"></div>
            </div>
        </div>
        
        <div class="tv-popup-buttons">
            <button class="tv-popup-btn play" onclick="playFromPopup()" tabindex="0" id="popup-play-btn"
                    data-focus="tv-popup-play">
                <i class="fas fa-play"></i>
                Riproduci
            </button>
            
            <button class="tv-popup-btn fav" onclick="toggleFavoriteFromPopup()" tabindex="0" id="popup-fav-btn"
                    data-focus="tv-popup-fav">
                <i class="fas fa-star"></i>
                <span id="popup-fav-text">Aggiungi ai Preferiti</span>
            </button>
        </div>
    </div>

    <!-- Footer per TV -->
    <footer class="tv-footer">
        <div class="tv-footer-content">
            <div class="tv-footer-logo">
                <i class="fas fa-tv"></i>
                <span>CineSearch TV Edition</span>
            </div>
            
            <div class="tv-footer-info">
                <p>Ottimizzato per Smart TV & Telecomando</p>
                <p class="tv-footer-help">
                    <i class="fas fa-info-circle"></i>
                    Usa i tasti direzionali per navigare, OK/Enter per selezionare
                </p>
            </div>
            
            <div class="tv-footer-copyright">
                <p>¬© 2025 CineSearch TV | v2.0</p>
            </div>
        </div>
    </footer>

    <button class="tv-top-btn" id="tv-top-btn" 
            onclick="scrollToTop()" 
            aria-label="Torna all'inizio"
            data-focus="tv-top-btn">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Notifiche Toast -->
    <div id="tv-toast" class="tv-toast"></div>

    <!-- Scripts -->
    <script src="tv-config.js"></script>
    <script src="tv-api.js"></script>
    <script src="tv-player.js"></script>
    <script src="tv-navigation.js"></script>
    <script src="tv-card.js"></script>
    <script src="tv-favorites.js"></script>
    <script src="tv-search.js"></script>
    <script src="tv-continua.js"></script>
    <script src="tv-categories.js"></script>
    <script src="tv-init.js"></script>
</body>
</html>